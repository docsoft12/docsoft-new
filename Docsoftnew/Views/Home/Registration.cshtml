@using Docsoftnew.Views.Components;
@model DocsoftBack.Registration.RegisterModels;
@{


		

	/*<app>
	<component type="typeof(Docsoftnew.Views.Components.Registor)" render-mode="ServerPrerendered" />
		</app>*/

}


    <script language="JavaScript">
        Webcam.set({
            width: 200,
            height: 200,
            image_format: 'jpeg',
            jpeg_quality: 90
        });
        Webcam.attach('#my_camera');
    </script>
    <!-- Code to handle taking the snapshot and displaying it locally -->
    <script language="JavaScript">
        function take_snapshot() {
            // take snapshot and get image data
            Webcam.snap(function (data_uri) {
                // display results in page
                document.getElementById('result').innerHTML =
                    '<img class="rounded-circle"  alt="Select image" src="' + data_uri + '"/>';

                Webcam.upload(data_uri,
                    '/images',
                    function (code, text) {
                        alert('Photo Captured');
                    });

            });
        }
    </script>


<div style="border:groove;background-color:white">
	<div style="margin:5px" class="container-fluid mt-4">



		<form asp-action="Registration" method="post">
			 
			<div class="row mt-2">

				
					<div class="col-md-4" id="my_camera">

					</div>


				


				<div class="text-center" id="result">
					
				</div>


			

			</div>

			<div class="row mt-1">

				<div class="text-center">
					<input type="button" class="btn btn-success" value="Take Snapshot" onclick="take_snapshot()" />

				</div>

</div>
  
			<hr />
			<div class="row	">
				<div class="col-md-1 col-sm-1">
					<label class="form-label">Mobile No:</label>
				</div>
				 	<div class="col-md-5 col-sm-5 ">
					<input asp-for="Mobile_No" type="number" id="mob_number"  maxlength="10" class="form-control" />
					<span asp-validation-for="Mobile_No" class="text-danger"></span>

				</div>
				 <div class="col-md-1 col-sm-1">
					<label class="form-label">Gender:</label>
 				</div>


				<div class="col-md-5 col-sm-5 ">
			 
					<select asp-for="Sex" id="select_mall" class="form-select"  >
						<option value="Male">Male</option>
						<option value="Female" >Female</option>
						<option value="Other" >Other</option>

					</select>
			 

				</div>


			</div>

			<div class="row mt-2">
				<div class="col-md-1 col-sm-1">
					<label class="form-label">Name:</label>

				</div>


				<div class="col-md-5 col-sm-5 ">
					<input asp-for="Patient_Name" type="text"  class="form-control" />
					<span  asp-validation-for="Patient_Name" class="text-danger"></span>

				</div>



				<div class="col-md-1 col-sm-1">
					<label class="form-label">Aadhar No:</label>

				</div>


				<div class="col-md-5 col-sm-5 ">
					<input asp-for="Aadhar_No" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"  type="number" maxlength="16" class="form-control" />
					<span asp-validation-for="Aadhar_No"  class="text-danger"></span>

				</div>

			</div>


			<div class="row mt-1">


				<div class="col-md-1 col-sm-1">
					<label class="form-label">Weight:</label>

				</div>


				<div class="col-md-2 col-sm-5 ">
					<input asp-for="Weight" type="number" class="form-control" />
					<span asp-validation-for="Weight" class="text-danger"></span>

				</div>


				<div class="col-md-1 col-sm-1">
					<label class="form-label">Age:</label>
				</div>


				<div class="col-md-2 col-sm-5 ">
					<input type="number" maxlength="3" id="age_value"   oninput="age_sh()" class="form-control" />
				</div>


				


				<div class="col-md-1 col-sm-1">
					<label class="form-label">Birth Date:</label>

				</div>


				<div class="col-md-2 col-sm-2 ">
					<input asp-for="Birthdate" id="date_pic" type="date" class="form-control" />

				</div>
				

				<div class="col-md-1 col-sm-1">
					<label class="form-label">Height:</label>

				</div>


				<div class="col-md-2 col-sm-2 ">
					<input asp-for="Height" type="text" class="form-control" />
					<span asp-validation-for="Height" class="text-danger"></span>

				</div>

			</div>

			<div class="row mt-1">
				<div class="col-md-1 col-sm-1">
					<label class="form-label">Address:</label>

				</div>


				<div class="col-md-11 col-sm-11 ">
					<input asp-for="Address" type="text" class="form-control" />
					<span asp-validation-for="Address" class="text-danger"></span>

				</div>

			</div>


			<div class="row mt-2">


				<div class="col-md-1 col-sm-1">
					<label class="form-label">City:</label>

				</div>


				<div class="col-md-5 col-sm-5 ">
					<input asp-for="City" type="text" class="form-control" />
					<span asp-validation-for="City" class="text-danger"></span>

				</div>





				<div class="col-md-1 col-sm-1">
					<label class="form-label">PinCode:</label>

				</div>


				<div class="col-md-5 col-sm-5 ">
					<input asp-for="Pincode" type="text" class="form-control" />
					<span asp-validation-for="Pincode" class="text-danger"></span>

				</div>



			</div>


			<hr />
			<div class="row mt-4">
				<div class="text-center">
					<button type="submit" id="btnCapture" class="btn btn-primary btn-sm">Go To Apointment</button>
					</div>
				 
				</div>
		






		</form>

		<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Allredy Exist!</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">


						<div id="namelist" style="height:250px;overflow-y:scroll" class="list-group">
						
						
						</div>


      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
 
      </div>
    </div>
  </div>
</div>
 
 
	</div>
</div>
<script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
<script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.js"></script>
<script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
<script src="~/lib/jquery-validation/dist/jquery.validate.js"></script>

<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/jquery/dist/jquery.js"></script>
<script>

	 

	function age_sh()
	{
		
		var get_age = $("#age_value").val();

		var age = get_age * 12;
	 

   
const date = new Date();

		date.setMonth(date.getMonth() - age);
		document.getElementById("date_pic").valueAsDate = new Date(date);
		 
	}
	 

	$("#mob_number").keyup(function () {
		if ($("#mob_number").val().length == 10) {
			$.ajax({
				type: 'POST',
				dataType: 'JSON',
				url: '/Home/CHKNUMBER',
				data: {
					number: $("#mob_number").val()
				},
				success: function (result) {
					if (!result || result.length == 0) {
						return;
					}
					$('#exampleModal').modal('show');
					$("#namelist").empty();
					$.each(result, function (i, item) {
						$("#namelist").append("<a onclick='GetAppoint(" + item.UHID + ")' class='list-group-item list-group-item-action'>" + item.Patient_Name + "</a>");
					});
				},
				error: function () {
					console.log('Failed ');
				}
			});
		}
	});


	function GetAppoint(UHID)
	{ 
		 
		$.ajax(
			{
				type: 'POST',
				dataType: 'JSON',
				url: '/Home/GetApooint',
				data: {UHID: UHID },
				success:
					function (response) {
 
						window.location.href = response.redirectUrl;

					},
				error:
					function (response) {
						alert("Error: " + response);
					}
			});
			 

	}


</script>