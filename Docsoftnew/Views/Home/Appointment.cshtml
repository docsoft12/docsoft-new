@using Docsoftnew.Views.Components;
@using Microsoft.JSInterop;
@using Microsoft.AspNetCore.Razor
@using DocsoftBack.Appopintment
@using DocsoftBack;
@inject Docsoftnew.Models.IHomeTrain train

@model ApponmentModels  
@{
	string timeslot = "";
	string data = "";
	AppointMentDataAccess mentDataAccess = new();

	List<ApponmentModels> Getapponments()
	{
		List<ApponmentModels> apponments = new();

		var sql = "";
		 
			sql = "select UHID,Patient_Name,Mobile_No,Aadhar_No from Petient_Details ";
    		apponments = MainEngine.GetList<ApponmentModels>(sql);
			return apponments;
		
	}
}

		

<div class="container-fluid" >

	@*<form method="post" >
	<div class="row mt-1">
		 
		<div class="col-md-1 col-sm-1">
			<label class="form-label">Search:</label>

		</div>
		<div class="col-md-5 col-sm-5">
			<input asp-for="Search"  class="form-control" type="text" />

		</div>
		<div class="col-md-4 col-sm-4">
			<button asp-controller="Home" asp-action="Search" type="submit">Search</button>
</div>
	</div>
 
 
</form>*@





	<div class="row mt-2">
		@*<table class="table">
			<thead>
				<tr>	
					<th>UHID</th>
					<th>Patient Name</th>
					<th>Mobile No</th>
					<th>Aadhar No</th>
				</tr>
			</thead>
			<tbody>

 
				@if (Model.Search!=null)
					{
				@foreach (var item in Getapponments(Model.Search))
						{<tr>
							<td>
								@item.UHID
							</td>
							<td>
								@item.Patient_Name
							</td>
							<td>
								@item.Mobile_No
							</td>
							<td>
								@item.Aadhar_No
							</td>

						</tr>

						}
					}
					
				 
			
			</tbody>


		</table>*@

	<table id="example" class="table table-striped table-bordered" style="width:100%">
		<thead>
				<tr>
					<th>UHID</th>
					<th>Patient Name</th>
					<th>Mobile No</th>
					<th>Aadhar No</th>
				</tr>
		</thead>
		<tbody id="getidhd" name="getidhd">

			 

			 @foreach (var item in Getapponments())
			 {
				 <tr>

							<td>
								@item.UHID
							</td>
							<td>
								@item.Patient_Name
							</td>
							<td>
								@item.Mobile_No
							</td>
							<td>
								@item.Aadhar_No
							</td>

						</tr>
						}
					
		</tbody>
	</table>






		<form method="post"  >
			<input type="text" hidden="hidden"   id="tablemasala" />

			<input hidden="hidden"  asp-for="@Model.UHID" id="doctorm"  />
		<div  class="row mt-2">
	
			<div class="col-md-2 col-sm-2" >
	<label class="form-label">Date:</label>
	</div>


		

	<div class="col-md-5 col-sm-5" >

				<input  id="getdate" asp-for="Attended_Time" class="form-control" type="date" />
	 

	</div>
			<div class="col-md-2 col-sm-2">
				  


					<input type="text"  asp-for="Ap_Time"  hidden="hidden"   id="store_list"   >
					<ul id="time_list"   class="list-group">
						 
							@*<li  class="list-group-item">@item</li>*@
	</ul>
				</div>

			</div>
	 
		<div class="row mt-2">
			<div class="col-md-2 col-sm-2">


				<label class="form-label">Faculty:</label>
				</div>
			<div class="col-md-5 col-sm-5">
	<select id="fac"    asp-for="faculty"   class="form-select">
		<optiton value="select" >Select</optiton>
@foreach (var item in mentDataAccess.GetCommon("Facalty"))
	{
		<option value="@item" >@item</option>
		}
	</select>
		</div>
		
</div>


		


		<div class="row mt-2">
			<div class="col-md-2 col-sm-2">
	<label class="form-label">Consultant Name:</label>
	</div>
	<div class="col-md-5 col-sm-5">
	<select asp-for="Consultant_ID" id="getemp"    class="form-select">
					@foreach (var item in mentDataAccess.GetEmployees())
					{
						<option value="@item.Employee_ID" >@item.Emp_Name</option>
					}
	</select>
		</div>

		</div>

		<div class="row mt-2">
						<div class="col-md-2 col-sm-2">
	<label class="form-label">Available Time:</label>
	</div>
			<div class="col-md-5 col-sm-5">
	<select id="abtime"  asp-for="Time_Slot"  class="form-select">
		<option></option>
	</select>

		</div>
		</div>


		<div class="row mt-2">
			<div class="col-md-2 col-sm-2">
	<label class="form-label">Source Time:</label>
	</div>
			<div class="col-md-5 col-sm-5">

	<select asp-for="Source" class="form-select">
					@foreach (var item in mentDataAccess.GetCommon("Source"))
					{
						<option value="@item">@item</option>
					}
				</select>
	
		</div>
		</div>

		<div class="row mt-2">
			<div class="col-md-2 col-sm-2">

	<label class="form-label">Payment Mode:</label>
	</div>
			<div class="col-md-5 col-sm-5">

	<select asp-for="Payment_Mode" class="form-select">
					@foreach (var item in mentDataAccess.GetCommon("Payment_Mode"))
					{
						<option value="@item" >@item</option>
					}
	</select>
		</div>
			</div>



		<div class="row mt-2">
			<div class="col-md-2 col-sm-2">
				<label class="form-label" >Fees</label>
			</div>

				<div class="col-md-2 col-sm-2">
					<input asp-for="Fees" type="text" class="form-control" />
				</div>

				<div class="col-md-1 col-sm-1">
					<label class="form-label" >Paid</label>
				</div>

				<div class="col-md-2 col-sm-2">
					<input asp-for="Fees_Received" class="form-control" type="text" />
				</div>
		</div>
		<div class="row mt-2">

			<div class="col-md-2 col-sm-2">
              <label class="form-label" >Payment Ref No</label>
</div>


<div class="col-md-5 col-sm-5">
	<input  type="text" class="form-control"  />
</div>
		</div>
		
	
		<div class="row mt-3">
			<div class="col-md-4">
				<button asp-controller="Home" asp-action="BookApoint" type="submit" class="btn btn-warning btn-sm" >Book Apoitment</button>
			</div>
		</div>
	 



		 




</form>

 </div>





 </div>


<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/jquery/dist/jquery.js"></script>
<script src="~/js/loadash.js"></script>

			  <script>
	$(document).ready(function () {
		$('#example').DataTable();
	});

				 let times;

	$("#time_list").click(function(event){


		var target = event.target;
	 

		times =  event.target.innerHTML;
	 
		document.getElementById("store_list").setAttribute('value', times);


	});




	//table get id from it
	$("#getidhd").click(function (event) {


		var target = event.target;



		times = event.target.innerHTML;
		console.log(times);
		 

		$.getJSON('Home/GETUID/'+times+'', function (data) {


			console.log(data);
		document.getElementById("doctorm").setAttribute('value', data);

				 
		 
		});
		 


	});




	$("#abtime").change(function () 
	{

		$('ul'). empty();
		$.getJSON('Home/GETLISTTIME/' + $('#abtime').val(), function (data) {



			$.each(data, function (i, item) {

			$("#time_list").append(" <li> " +  item+ "</li>");
			})
		});

	});

	$("#getemp ").change(function () {
	 
		var weekday = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];

 
		var d = document.getElementById('getdate').valueAsDate;
		var n = d.getUTCDay()

		var store = weekday[n];

		
	
			$.getJSON('Home/gettime/' + $('#getemp').val(), { id2: store }, function (data) {

			//clear the current content of the select
			$('#abtime').empty();

			//iterate over the data and append a select option
			$.each(data, function (i, item) {
				$('#abtime').append('<option value="' + item.Start_Time + '-'+ item.End_TIme+'">'
					+ item.Start_Time + '-' + item.End_TIme + '</option>');
			})
		});
			$.getJSON('Home/gettime/' + $('#getemp').val(), { id2: store }, function (data) {

			//clear the current content of the select
			$('#abtime').empty();

			//iterate over the data and append a select option
			$.each(data, function (i, item) {
				$('#abtime').append('<option value="' + item.Start_Time + '-'+ item.End_TIme+'">'
					+ item.Start_Time + '-' + item.End_TIme + '</option>');
			})
		});
	});
</script>
